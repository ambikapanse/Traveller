{% extends 'base.html' %}
{% block start %}
    <!-- Tab panes -->
    <div class="container mt-4">
        <div class="container-fluid custom-padding">
            <div class="row justify-content-center">
                <!-- First column -->
                <div class="col-md-3">
                    <div class="tab-content">
                        <div id="tab1" class="container-fluid tab-pane active">
                            <div class="card custom-card">
                                <div class="row post-header col-12 py-2 px-3">
                                    <div class="col-6 float-left">
                                        <h4>Daily Stats</h4>
                                    </div>
                                </div>
                                <div class="custom-img-container">
                                    <img class="card-img custom-img" src="https://via.placeholder.com/300x300"
                                         alt="Time Spent"></div>
                                <div class="card-body px-3">
                                    <h5 class="card-title">Time Spent</h5>
                                </div>
                            </div>
                        </div>
                        <!-- What's New -->
                        <div class="container-fluid tab-pane active mt-3">
                            <div class="card custom-card">
                                <div class="row post-header col-12 py-2 px-3">
                                    <div class="col-6 float-left">
                                        <h4>What's New</h4>
                                    </div>
                                </div>
                                <div class="custom-img-container">
                                    <img class="card-img custom-img" src="https://via.placeholder.com/300x300"
                                         alt="New Article">
                                </div>
                                <div class="card-body px-3">
                                    <h5 class="card-title">Article</h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Second column -->
                <div class="col-md-6">
                    <div class="tab-content">
                        <!-- <div id="tab2" class="container-fluid tab-pane active"> -->
                            {% for post in post_items %}
                            <div class="card custom-card">
                                <div class="row post-header col-12 py-2 px-3">
                                    <div class="col-6 float-left">
                                        <h4>{{post.location}}</h4>
                                    </div>
                                </div>
                                <div class="custom-img-container">
                                    <img class="card-img custom-img"
                                         src="{{ post.picture.url }}"
                                         alt="{{ post.location }}">
                                </div>
                                <div class="card-body px-3">
                                    <div class="d-flex justify-content-between">
                                        <h5 class="card-title">{{ post.user }}</h5>
                                        <h5 class="card-title">{{ post.likes }} Likes</h5>
                                        <a href="#" class="like-button" data-post-id="{{ post.id }}">
                                            {% if user in post.like_set.all %}
                                                Unlike
                                            {% else %}
                                                Like
                                            {% endif %}
                                        </a>
                                    </div>
                                    <p class="card-text">{{ post.caption }}</p>
                                </div>
                                <div class="row post-footer px-3 pb-3">
                                    <div class="col-1 float-left text-left">
                                        <i class="far fa-heart"></i>
                                    </div>
                                    <div class="col-1 float-right text-right">
                                        <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                        <!-- </div> -->
                    </div>
                </div>

                <!-- Third column -->
                <div class="col-md-3">
                    <div class="card">
                        <div class="card-row post-header col-12 py-2 px-3ÅŒ">
                            <h5>People</h5>
                        </div>
                        <div class="card-body">
                            <div class="media mb-3">
                                <img src="path/to/profile-picture.jpg" class="mr-3 rounded-circle" alt="Profile Picture"
                                     style="width: 50px; height: 50px;">
                                <div class="media-body">
                                    <h6 class="mt-0">Username</h6>
                                    Location
                                </div>
                            </div>
                            <div class="media mb-3">
                                <img src="path/to/profile-picture.jpg" class="mr-3 rounded-circle" alt="Profile Picture"
                                     style="width: 50px; height: 50px;">
                                <div class="media-body">
                                    <h6 class="mt-0">Username</h6>
                                    Location
                                </div>
                            </div>
                            <!-- Add more users as needed -->
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.like-button').forEach(function(button) {
                button.addEventListener('click', function(event) {
                    event.preventDefault();
                    var postId = this.getAttribute('data-post-id');
                    var likeButton = this;
                    var likesCount = likeButton.previousElementSibling.querySelector('.likes-count');
    
                    fetch(`/like/${postId}/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': '{{ csrf_token }}'
                        }
                    })
                    .then(response => response.json())
                    .then(data => {
                        likesCount.textContent = data.likes;
                        if (likeButton.textContent.trim() === 'Like') {
                            likeButton.textContent = 'Unlike';
                        } else {
                            likeButton.textContent = 'Like';
                        }
                    })
                    .catch(error => console.error('Error:', error));
                });
            });
        });
    </script>

{% endblock %}